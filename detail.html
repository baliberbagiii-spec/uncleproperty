<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Detail Proyek — Uncle Property</title>
  <link rel="stylesheet" href="styles.css">
  <script src="data.js" defer></script>
  <link rel="icon" href="ico.ico" type="image/x-icon">
  <script>
    // Fungsi ambil parameter ID dari URL
    function qparam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    document.addEventListener('DOMContentLoaded', () => {
      const id = qparam('id');
      const container = document.getElementById('detail-root');

      if (!id) {
        container.innerHTML = '<p>Proyek tidak ditemukan. Pastikan URL berisi id proyek.</p>';
        return;
      }

      const p = projects.find(x => x.id === id);
      if (!p) {
        container.innerHTML = '<p>Proyek tidak ditemukan.</p>';
        return;
      }

      document.title = p.title + ' — Uncle Property';

      // Jika p.images (array) tersedia gunakan slider
      let imageSlider = "";
      if (p.images && p.images.length > 0) {
        imageSlider = `
          <div class="slider-container">
            <div class="slider">
              ${p.images.map(img => `<img src="${img}" alt="${p.title}">`).join('')}
            </div>
            <button class="slider-btn prev">&#10094;</button>
            <button class="slider-btn next">&#10095;</button>
          </div>
        `;
      } else {
        imageSlider = `
          <div class="slider-container">
            <div class="slider">
              <img src="${p.image}" alt="${p.title}">
            </div>
          </div>
        `;
      }

      // Render konten detail
      container.innerHTML = `
        <article class="detail-card">
          <div class="detail-visual">
            ${imageSlider}
          </div>
          <div class="detail-body">
            <h1>Kavling – ${p.title}</h1>
            <p class="meta">${p.location}</p>
            <p class="price">Harga: <strong><i>${p.price}</i></strong></p>
            <p class="desc">${p.description}</p>
            <br />
            <h2>Untuk info lebih lanjut hubungi</h2>
            <div class="detail-actions"><center>
              <a class="whatsapp-btn" href="https://wa.me/62895365282575?text=${encodeURIComponent('Halo, saya tertarik dengan kavling ' + p.title + '. Tolong berikan saya informasi lengkapnya.')}" target="_blank" rel="noopener">WhatsApp</a>
            </div>
          </div>
        </article>
      `;

      // ==== Slider Logic ====
      const slider = document.querySelector('.slider');
      const slides = document.querySelectorAll('.slider img');
      const prevBtn = document.querySelector('.prev');
      const nextBtn = document.querySelector('.next');
      let index = 0;

      function showSlide(i) {
        if (!slides.length) return;
        if (i < 0) index = slides.length - 1;
        else if (i >= slides.length) index = 0;
        else index = i;
        slider.style.transform = `translateX(-${index * 100}%)`;
      }

      if (prevBtn && nextBtn) {
        prevBtn.addEventListener('click', () => showSlide(index - 1));
        nextBtn.addEventListener('click', () => showSlide(index + 1));
        setInterval(() => showSlide(index + 1), 5000);
      }
    });
  </script>
</head>

<body class="detail-page">
  <header class="site-header">
    <div class="brand"><h2>Uncle<span><i>Property</i></span></h2></div>
    <nav class="nav">
      <button onclick="window.location.href='index.html'">Beranda</button>
    </nav>
  </header>

  <main class="container">
    <div id="detail-root" class="detail-root">
      <!-- konten akan dimuat lewat JS -->
    </div>
  </main>

  <footer class="site-footer">
    Semua Hak Dilindungi <strong>© 2025 Uncle Property</strong>
  </footer>
</body>
</html>
